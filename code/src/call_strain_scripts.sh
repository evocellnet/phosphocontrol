#!/bin/bash
#SBATCH --job-name=phosphomaster
#SBATCH --cpus-per-task=1
#SBATCH --mem-per-cpu=2G
#SBATCH -o main_job.out
#SBATCH -e main_job.err

# Script to run strain analysis of phosphosites in HPC

# Array of phosphosites, each in the format "UniprotID_phosphosite"
psites=(O94804_191 O15530_241 P21802_769 Q9WV60_216 O31465_74 A0A2K3DQY7_239 P78527_2638 Q29495_31 P05132_11 P68400_2 Q7CWV1_405 Q9H3Z4_10 O14920_177 Q92630_458 Q92731_488 P96356_78 O06291_280 A0A2K3E0K3_176 Q9NWZ3_345 Q13188_180 P07949_928 P61006_111 P06276_226 B7UL96_59 P08879_119 P0CG47_172 P08877_15 O60260_65 O00092_81 P28482_125 P07949_905 P05187_114 P9WI81_173 P32356_60 P63086_183 Q9NWZ3_342 P11309_276 P48730_220 P04629_677 P05132_140 P61015_16 A0A2K3DQY7_168 P08149_465 Q564N5_56 Q13191_363 P9WI83_21 A0A2K3DQY7_712 Q9F4L3_28 Q5NHF4_247 A0A2K3E0K3_178 O75385_180 P13807_641 P28482_187 P07332_713 Q3JWH7_9 A0A2K3DQY7_514 P27361_204 P23874_150 P84022_425 P07471_23 Q9UHD2_172 A0A7M4DUC2_1525 P12694_337 Q9QZL0_184 D3KVM3_276 A0A2K3DQY7_77 P22413_486 O75460_729 P21802_586 A0A2K3DQY7_42 Q9QZL0_232 Q16594_8 Q13627_301 A1YYW7_89 P11309_261 Q94F62_312 P06737_15 P00519_50 Q05609_710 P78527_2645 Q05609_704 Q9NYL2_161 P05132_198 Q79PF4_431 Q96RR4_345 P05132_339 P23443_394 Q64610_209 O43683_969 P06239_394 P15693_112 Q05609_707 Q16288_706 P0CG47_164 P23443_390 Q61686_14 A0A2K3DQY7_249 Q79V60_432 P25321_140 Q16539_182 P18669_11 P52333_981 P39984_34 D6WMX4_207 P47811_182 Q9HCE5_399 P01012_345 P07949_809 P49841_9 P31751_309 P28327_8 Q9Y6E0_190 A8IE32_339 O75531_3 P29317_772 P24723_513 Q61686_13 P36887_339 Q07955_209 P35557_411 Q94F62_455 P00634_124 P12931_419 O60674_1008 P63086_185 O75460_724 P02974_75 P08559_293 P54762_647 Q16875_254 P9WG47_129 P54646_172 P07949_909 P43405_526 P28482_185 A0A2K3DQY7_244 P17612_11 P07515_46 P54760_774 P47811_180 O75533_129 Q9WV60_9 P00517_11 P0CG47_218 P33981_676 O14939_573 Q92630_232 Q9X1F5_59 P25321_11 P31751_451 P01112_64 O32723_57 P17612_140 O14965_288 P15056_729 P07953_259 A0A2K3DQY7_510 P06786_782 Q13882_342 P32356_83 P31749_477 P41743_484 Q13153_423 P00489_15 Q14653_386 P00791_127 P61925_22 Q9KWY4_84 P0CE47_383 P07102_39 P61006_72 P00949_117 P22607_648 P9WI83_152 A0A2K3DQY7_708 P53597_299 P24941_160 A0A2K3DQY7_212 P36871_117 P07477_154 P07830_54 Q94F62_290 P9WI83_46 P49841_277 P0AGE9_247 O43293_50 Q2RIF5_58 P32989_274 Q2UNF9_38 Q13188_268 A0A2K3DQY7_706 P63248_22 P33284_15 P07949_900 Q99640_260 O18734_38 A8IE32_344 P9WKD3_84 O94804_185 A0A2K3D4W3_328 Q07955_207 P27577_41 Q9I6W2_68 P49759_341 A0A0K8P8E7_225 P42530_84 P00523_416 P29322_793 Q9L387_85 O15264_182 H2DZ00_228 P39579_36 H2DZ00_232 Q26069_12 Q93VE0_27 P46108_221 P10721_570 Q51578_88 Q00944_576 O15264_180 Q8ZVF7_82 A0A2K3E0K3_177 P84022_423 A0A2K3DQY7_505 Q94F62_324 P00517_140 Q07955_201 Q04759_676 Q13188_174 Q71V39_300 Q71V39_239 A5JUY8_315 Q564N5_79 A0A2K3DQY7_523 P12931_338 Q92918_171 P00517_339 Q92918_165 P11802_172 P07854_94 A0A7M4DUC2_1547 P33981_677 A0A2K3DQY7_714 P16892_182 P24941_15 B1L3C9_254 D3KVM3_12 G0SCK6_160 P46109_207 P0AA04_15 P22681_371 Q61686_12 P27577_38 G0SCK6_163 P22413_256 O62305_284 P07738_11 Q06210_261 O14920_257 Q9UK32_232 B7GTV0_75 Q61686_11 Q8PGN7_99 A0A2K3DQY7_173 Q00944_577 Q13131_183 A0A2K3CR90_564 P12928_144 P31324_112 O19069_299 O43293_265 Q9QZL0_231 A0A2K3DQY7_251 P22607_647 Q16539_180 O14920_181 P29320_701 Q96RR4_400 O14965_287 P36495_1795 P21802_656 O75460_726 H2DZ00_237 P03870_343 P9WI81_171 Q5ZSZ6_54 P43405_525 Q13523_849 A0A2K3DQY7_537 O43353_111 P01012_69 O75531_4 Q9H8S9_35 P08200_113 O60674_1007 O28025_18 P78527_2647 Q564N5_74 Q9SRQ7_158 P08877_46 P9WI83_224 P49841_216 P07355_24 P22887_122 O06976_46 P69797_10 P53778_185 Q7Z4H3_10 P49759_342 A0A2K3DQY7_229 P22607_577 P62707_11 A0A1C3NEV1_283 Q14653_402 P19525_446 Q99XG5_123 Q9NWZ3_346 P23443_252 P53778_183 P54762_778 P52956_126 Q96EY4_127 Q8DTU0_92 Q71V39_163 A0A452E9Y6_315 P12928_43 P78527_2609 P21802_657 P0CG47_217 P26276_108 P21802_561 P52333_980 P38319_182 P33981_675 O96013_562 O94804_208 P80025_315 P17612_339 Q818Z9_85 Q9H8S9_12 P06612_319 A0A0R6L508_285 Q15393_613 O75385_87 P50613_164 P20906_26 P33981_686)

c=0

for i in {0..347}
do
    # Run block of code to calculate the correlation dimension for each phosphosite
    cp base_script.sh script_"$c".sh
    echo srun python3 calculate_cd_script.py "${psites[$i]}" >> script_"$c".sh
    sbatch script_"$c".sh
    c=$(($c + 1))

    # Run block of code to calculate pairwise distances for each phosphosite
    cp base_script.sh script_"$c".sh
    echo srun python3 calculate_pdist_script.py "${psites[$i]}" >> script_"$c".sh
    sbatch script_"$c".sh
    c=$(($c + 1))
done

